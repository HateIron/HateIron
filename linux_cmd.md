#<center>linux 命令</center>

<span id='jump'></span>

[TOC]

# 一、 linux 切换 IP 后，快速恢复网络

## 1、将常用命令保存在`/readme`中

```powershell
[wishcell@localhost ~]$
[wishcell@localhost ~]$ cat /readme
ifconfig enp0s3 192.168.43.222 netmask 255.255.255.0 up
ifconfig enp0s3 192.168.1.222 netmask 255.255.255.0 up

vim /etc/resolv.conf
vim /etc/sysconfig/network-scripts/ifcfg-enp0s3
service network restart
[wishcell@localhost ~]$
```

## 2、查看配置文件

```powershell
[wishcell@localhost ~]$ cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 8.8.8.8
nameserver 8.8.4.4
[wishcell@localhost ~]$
```

## 3、修改配置文件`/etc/sysconfig/network-scripts/ifcfg-enp0s3`

```powershell
vim /etc/sysconfig/network-scripts/ifcfg-enp0s3

#PROXY_METHOD=none
#BROWSER_ONLY=no
#BOOTPROTO=dhcp
#DEFROUTE=yes
#IPV4_FAILURE_FATAL=no
#IPV6INIT=yes
#IPV6_AUTOCONF=yes
#IPV6_DEFROUTE=yes
#IPV6_FAILURE_FATAL=no
#IPV6_ADDR_GEN_MODE=stable-privacy
#NAME=enp0s3
#UUID=021a3d3d-b514-4292-b6d2-115c44a53e2a


TYPE=Ethernet
DEVICE=enp0s3
ONBOOT=yes
BOOTPROTO=static
#IPADDR=192.168.43.222
IPADDR=192.168.1.222
NETMASK=255.255.255.0
#NETWORK=192.168.43.0
NETWORK=192.168.1.0
#BROADCAST=192.168.43.255
BROADCAST=192.168.1.255
#GATEWAY=192.168.43.1
GATEWAY=192.168.1.1

DNS1=8.8.8.8
DNS2=8.8.4.4
```

## 4、重启网络

```powershell
[root@localhost wishcell]# service network restart
Restarting network (via systemctl):                        [  OK  ]
[root@localhost wishcell]# 
```

## 5、配置网卡上线

```powershell
# ifconfig enp0s3 192.168.1.222 netmask 255.255.255.0 up
```

## 6、 ping 通外网

```powershell
[root@localhost wishcell]# ping www.baidu.com -c 3
PING www.a.shifen.com (119.75.216.20) 56(84) bytes of data.
64 bytes from 119.75.216.20 (119.75.216.20): icmp_seq=1 ttl=54 time=36.8 ms
64 bytes from 119.75.216.20 (119.75.216.20): icmp_seq=2 ttl=54 time=50.5 ms
64 bytes from 119.75.216.20 (119.75.216.20): icmp_seq=3 ttl=54 time=35.6 ms

--- www.a.shifen.com ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2330ms
rtt min/avg/max/mdev = 35.697/41.031/50.561/6.758 ms
[root@localhost wishcell]#
```

# 二、查看串口的命令

##1、linux 下怎样查看串口使用情况

```powershell
[WishCell@localhost root]$ dmesg | grep ttyS*
console [tty0] enabled
serial8250: ttyS0 at I/O 0x3f8 (irq = 4) is a 16550A
00:05: ttyS0 at I/O 0x3f8 (irq = 4) is a 16550A
0000:03:03.0: ttyS1 at I/O 0xe400 (irq = 21) is a 16550A
0000:03:03.0: ttyS2 at I/O 0xe000 (irq = 21) is a 16550A
[WishCell@localhost root]$
```

## 2、查看串口名称使用

```powershell
一般情况下串口的名称全部在dev下面，
如果你没有外插串口卡的话默认是dev下的ttyS*,
一般ttyS0对应com1，ttyS1对应com2，当然也不一定是必然的；
[WishCell@localhost root]$ ls -l /dev/ttyS*
crw-rw----. 1 root dialout 4, 64 9月 26 09:22 /dev/ttyS0
crw-rw----. 1 root dialout 4, 65 9月 26 09:22 /dev/ttyS1
crw-rw----. 1 root dialout 4, 66 9月 26 09:23 /dev/ttyS2
crw-rw----. 1 root dialout 4, 67 9月 25 07:26 /dev/ttyS3
[WishCell@localhost root]$
```

##3、查看串口驱动，PC上的串口一般是ttyS，板子上Linux的串口一般叫做ttySAC

```powershell
[root@localhost ~]# cat /proc/tty/driver/serial
serinfo:1.0 driver revision:
0: uart:16550A port:000003F8 irq:4 tx:59 rx:0 RTS|DTR
1: uart:16550A port:0000E400 irq:21 tx:62 rx:0 RTS|DTR
2: uart:16550A port:0000E000 irq:21 tx:57 rx:0 RTS|DTR
3: uart:unknown port:000002E8 irq:3
```



# 三、查看端口占用，进程情况

## 1、查看端口被哪个进程占用

```powershell
[root@ unittest]#netstat -apn | grep 8080
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      154123/./tt     
tcp        0      0 20.63.180.95:8080       10.63.180.91:51133      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51130      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51132      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51129      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51135      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51131      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51128      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51136      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51127      TIME_WAIT   -
tcp        0      0 20.63.180.95:8080       10.63.180.91:51134      TIME_WAIT   -
[root@ unittest]#pkill tt
[root@ unittest]#netstat -apn | grep 8080
[root@ unittest]#
[root@ unittest]#netstat -apn | grep 80
tcp    0    0 0.0.0.0:80        0.0.0.0:*           LISTEN      3630/nginx: master  
tcp    0    0 10.63.180.95:22   10.63.180.93:1797   ESTABLISHED 129612/sshd: server
```



# 四、让程序在后台运行的方法

## 1、setsid

```powershell
[root@localhost ngrok]# setsid ./bin/ngrokd -tlsKey="assets/server/tls/snakeoil.key" -tlsCrt="assets/server/tls/snakeoil.crt" -domain="myngrok"  -httpAddr=":80" -httpsAddr=":8082" -tunnelAddr=":8083"
```





# 五、常用关机命令

```powershell
1、shutdown
	普通安全。
	通知 init 进程，要求它改变运行级别。级别 0 关机。 级别6重启

    # shutdown
    # shutdown now
    # shutdown 13:20  
    # shutdown -p now  ### 关闭机器
    # shutdown -H now  ### 停止机器      
    # shutdown -r09:35 ### 在 09:35am 重启机器
    
2、halt
    只是调用了 shutdown
    # halt             ### 停止机器
    # halt -p          ### 关闭机器
    # halt --reboot    ### 重启机器
3、poweroff 会发送一个 ACPI 信号来通知系统关机。
    # poweroff           ### 关闭机器
    # poweroff --halt    ### 停止机器
    # poweroff --reboot  ### 重启机器
    
4、reboot 命令
    # reboot           ### 重启机器
    # reboot --halt    ### 停止机器
    # reboot -p        ### 关闭机器
```



# 六、



# 七、



